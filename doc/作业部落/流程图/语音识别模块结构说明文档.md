# 语音识别模块结构说明文档

标签： 流程图

---

###　语音识别模块各回调函数流程图
####　开始语音识别消息回调函数流程图
```flow
st=>start: Start:>https://www.zybuluo.com
c1=>condition: 已开启语音识别
c2=>condition: 正在播放语音
op1=>operation: 等待１s#有人#
op2=>operation: 发送“#有人#”的消息
开启语音识别
e=>end

st->c1
c1(no)->c2
c1(yes)->e
c2(yes)->op1->c2
c2(no)->op2->e
```
####　停止语音识别消息回调函数流程图
```flow
st=>start: Start:>https://www.zybuluo.com
c1=>condition: 已开启语音识别
c2=>condition: 正在播放语音
op1=>operation: 等待１s#有人#
op2=>operation: 将参数服务器参数
“voice/voice_is_recognitioning”
置为false
e=>end

st->c1
c1(yes)->c2
c1(no)->e
c2(yes)->op1->c2
c2(no)->op2->e
```
####　机器人工作模式回调函数流程图
```flow
st=>start: Start:>https://www.zybuluo.com
c1=>condition: 进入迎宾模式
op1=>operation: 将参数“is_obstacle_check”
置为true
op2=>operation: 将参数“is_obstacle_check”
置为false
e=>end

st->c1
c1(yes)->op1->e
c1(no)->op2->e
```
####　深度深度摄像头数据回调函数流程图
```flow
st=>start: Start:>https://www.zybuluo.com
c1=>condition: 变量
“is_obstacle_check”
为true
c2=>condition: 深度摄像头信息表示有障碍
未进入语音识别
连续5次有障碍消息
c3=>condition: 深度摄像头信息表示无障碍
已进入语音识别
连续5次无障碍消息
op1=>operation: 发送语音识别开始消息
op2=>operation: 发送语音识别结束消息
e=>end

st->c1
c1(yes)->c2
c1(no)->e
c2(yes)->op1->e
c2(no)->c3
c3(yes)->op2->e
c3(no)->e
```


####　语音识别结果回调函数流程图
```flow
st=>start: Start:>https://www.zybuluo.com
c1=>condition: 处于语音交互
op1=>operation: 打开语音板的麦克风输入
显示思考的表情
获取答案并合成音频
显示说话的表情
播放音频文件
c2=>condition: 处于语音交互
op2=>operation: 显示语音识别的表情
进行语音识别
c3=>condition: 识别结果非无效字符
op3=>operation: 显示思考的表情
获取答案并合成音频
c4=>condition: 答案为“#播放歌曲#”
op4=>operation: 随机播放一首歌曲
c5=>condition: 答案为“#跳舞#”
op5=>operation: 播放舞曲并发送跳舞开始消息
op6=>operation: 将答案合成音频文件并播放
op7=>operation: 显示休息的表情
e=>end

st->c1
c1(yes)->op1->c2
c1(no)->c2
c2(yes)->op2->c3
c2(no)->op7->e
c3(yes)->op3->c4
c4(yes)->op4->c2
c4(no)->c5
c5(yes)->op5->c2
c5(no)->op6->c2
```
