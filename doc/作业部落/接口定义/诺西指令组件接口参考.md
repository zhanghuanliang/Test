# 诺西指令组件接口参考

标签： 接口定义

---
[TOC]

### 一、诺西参数查询修改需求简介

#### 1、诺西厂家参数修改：
- 上传xml文件示例
```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE raml SYSTEM "raml20.dtd">

<raml xmlns="raml20.xsd" version="2.0">  
  <cmData type="plan" scope="all" name="yytest_plan2" id="PlanConfiguration( 526 )"> 
    <header> 
      <log dateTime="2016-03-09T16:10:34" action="created" appInfo="PlanExporter">InternalValues are used</log> 
    </header>  
    <managedObject class="LNCEL" version="LN5.0" distName="PLMN-PLMN/MRBTS-101010/LNBTS-101010/LNCEL-11" id="103110" operation="update"> 
      <p name="a3Offset">2</p> 
    </managedObject> 
  </cmData> 
</raml>

```
- 说明
```
将参数修改的命令编辑完成之后生成XML格式文件，下发到诺西厂家OMC进行执行。
上传Plan（XML文件）文件到诺西厂家OMC的/d/oss/global/var/racops/import文件夹下（注意：每次planName不允许和之前的重复，planName必须和plan文件中的name保持一致）执行以下命令进行参数修改：
1、Import Plan
racclimx.sh -op Import_Export -planName <PLANNAME> -importExportOperation planImport -fileName <FILENAME>
2、Validate plan
racclimx.sh -op Validate -planName <PLANNAME>
3、Provision plan
racclimx.sh -op Provision -planName <PLANNAME>
根据执行结果反馈的是finish还是error判定是否执行成功。
```
参数修改xml(浪潮)
```
<raml version="2.0" xmlns="raml20.xsd">
   <cmData type="plan" scope="all" name="Inspur_Plan_1511330670107">
      <header>
         <log dateTime="2017-11-22 14:04:30" action="created" appInfo="PlanExporter">InternalValues are used</log>
      </header>
      <managedObject class="LNCEL" version="LN5.0" distName="PLMN-PLMN/MRBTS-117591/LNBTS-117591/LNCEL-23/LNHOG-1" id="8171369" operation="update">
         <p name="b2Threshold2RssiGERAN">-86</p>
         <list name="arfcnValueListGERAN">
            <p>18</p>
            <p>16</p>
            <p>2</p>
            <p>24</p>
            <p>585</p>
            <p>583</p>
            <p>581</p>
            <p>569</p>
            <p>6</p>
            <p>17</p>
            <p>36</p>
            <p>12</p>
            <p>22</p>
            <p>11</p>
            <p>575</p>
            <p>565</p>
            <p>567</p>
            <p>573</p>
            <p>13</p>
            <p>19</p>
            <p>3</p>
            <p>21</p>
            <p>15</p>
            <p>18</p>
            <p>16</p>
            <p>2</p>
            <p>24</p>
            <p>585</p>
            <p>583</p>
            <p>581</p>
            <p>569</p>
            <p>6</p>
            <p>17</p>
            <p>36</p>
            <p>12</p>
            <p>22</p>
            <p>11</p>
            <p>575</p>
            <p>565</p>
            <p>567</p>
            <p>573</p>
            <p>13</p>
            <p>19</p>
            <p>3</p>
            <p>21</p>
            <p>15</p>
            <p>25</p>
         </list>
      </managedObject>
   </cmData>
</raml>

```



#### 2、诺西厂家参数查询:
- 说明
```
通过语句获取小区参数文件，在参数文件中解析查询选择的参数进行呈现。
在导出的参数文件中
<p name="a1TimeToTriggerDeactInterMeas">9</p>
表示a1TimeToTriggerDeactInterMeas参数的值为9
参数文件导出语句如下：
racclimx.sh -op Import_Export -fileFormat RAML2 -importExportOperation actualExport -DN PLMN-PLMN -fileName export_all.xml
导出的文件会自动存放在/d/oss/global/var/racops/export目录下
```
- 导出xml文件示例
```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE raml SYSTEM "raml20.dtd">

<raml xmlns="raml20.xsd" version="2.0"> -
  <cmData type="actual"> 
    <header> 
      <log appInfo="ActualExporter" action="created" dateTime="2016-03-10T12:32:00">InternalValues are used</log> 
    </header>  
    <managedObject version="LNT5.0" id="652164" distName="PLMN-PLMN/MRBTS-101010/LNBTS-101010/LNCEL-11/LNRELG-10" class="LNRELG"> 
      <p name="arfcnValueGeran">571</p>  
      <p name="basestationColourCode">3</p>  
      <p name="dtm">0</p>  
      <p name="name">460 00 6187 24866</p>  
      <p name="networkColourCode">7</p>  
      <p name="mcc">460</p>  
      <p name="mnc">00</p>  
      <list name="sibSchedulingList">-
        <item> 
          <p name="siMessagePeriodicity">1</p>  
          <p name="siMessageRepetition">1</p>  
          <p name="siMessageSibType">5</p> 
        </item> -
        <item> 
          <p name="siMessagePeriodicity">1</p>  
          <p name="siMessageRepetition">1</p>  
          <p name="siMessageSibType">3</p> 
        </item> 
      </list>  
      <p name="targetCellDn">PLMN-PLMN/EXCCG-1/EXGCE-1745</p>  
      <p name="ci">24866</p>  
      <p name="eNACCAllowed">1</p>  
      <p name="lac">6187</p>  
      <p name="nrControl">0</p>  
      <p name="redirWithSysInfoAllowed">1</p>  
      <p name="srvccAllowed">0</p> 
    </managedObject> 
  </cmData> 
</raml>

```
### 二、指令组件通用诺西接口(仅供参考)

支持直连omc上传下载文件

参数修改
```
1.omcID

2.需要上传的xml本地文件路径（全）

3.多条指令（上传文件后依次执行）


```
参数查询

```
1.omcID

2.需要下载的xml本地文件存放路径（全？）

3.多条/单条指令（依次执行后等待下载文件）
```



application.yml
```
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false
```

报错信息
```
{
    "timestamp": 1530523509775,
    "status": 500,
    "error": "Internal Server Error",
    "exception": "feign.FeignException",
    "message": "status 500 reading ICommandOperationOpenClient#executeCommands(ExecuteParameterQueryCommandsEntity); content:\n{\"timestamp\":1530523509690,\"status\":500,\"error\":\"Internal Server Error\",\"exception\":\"org.springframework.dao.RecoverableDataAccessException\",\"message\":\"\\n### Error querying database.  Cause: java.sql.SQLRecoverableException: No more data to read from socket\\n### The error may exist in URL [jar:file:/opt/java-pigeon/boco-rnop-biz-pigeon-service/boco-rnop-biz-pigeon-service-1.0.0.jar!/BOOT-INF/classes!/mybatis/mapper/default/common/ParameterOperationMapper.xml]\\n### The error may involve defaultParameterMap\\n### The error occurred while setting parameters\\n### SQL: select b.name as   enodeb_name,a.name as eutrance_Cell_Name,b.omc_id   from   eutrancell   a,enodeb b where a.related_enodeb=b.int_id and   a.cgi=? and   rownum=1\\n### Cause: java.sql.SQLRecoverableException: No more data to read from socket\\n; SQL []; No more data to read from socket; nested exception is java.sql.SQLRecoverableException: No more data to read from socket\",\"path\":\"/commandOperationOpen/executeCommands\"}",
    "path": "/commandOperationOpen/executeCommands"
}
```